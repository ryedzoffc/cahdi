<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CBT Pengetahuan Umum SMP Level Mudah</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2c3e50;
            --accent: #e74c3c;
            --success: #27ae60;
            --warning: #f39c12;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --gray: #7f8c8d;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.2);
            position: relative;
        }
        
        header {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 40px 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 60%);
            transform: rotate(30deg);
        }
        
        h1 {
            font-size: 3rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        .description {
            font-size: 1.3rem;
            margin-bottom: 25px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            position: relative;
        }
        
        .btn-container {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 25px;
            flex-wrap: wrap;
            position: relative;
        }
        
        .btn {
            padding: 15px 30px;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            min-width: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-primary {
            background: linear-gradient(to right, var(--primary), #2980b9);
        }
        
        .btn-success {
            background: linear-gradient(to right, var(--success), #219652);
        }
        
        .btn-danger {
            background: linear-gradient(to right, var(--accent), #c0392b);
        }
        
        .btn-secondary {
            background: linear-gradient(to right, var(--gray), #95a5a6);
        }
        
        .login-form, .dashboard, .test-container, .result-container, .admin-panel {
            padding: 40px;
            display: none;
        }
        
        .form-group {
            margin-bottom: 25px;
            position: relative;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--secondary);
        }
        
        input[type="text"],
        input[type="email"],
        input[type="password"],
        textarea,
        select {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .user-profile {
            background: linear-gradient(to right, #e8f4fc, #c5e3f7);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .user-profile::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: var(--primary);
        }
        
        .rules {
            background: linear-gradient(to right, #f9f9f9, #eef2f7);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .rule-list {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        .rule-list li {
            margin-bottom: 10px;
            position: relative;
        }
        
        .rule-list li::before {
            content: '•';
            color: var(--primary);
            font-weight: bold;
            display: inline-block;
            width: 1em;
            margin-left: -1em;
        }
        
        .timer {
            position: sticky;
            top: 0;
            background: linear-gradient(to right, #e74c3c, #c0392b);
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 1.4rem;
            z-index: 100;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .question {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .options {
            margin-top: 20px;
        }
        
        .option {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 10px;
            transition: all 0.3s;
            border: 2px solid #eee;
            cursor: pointer;
        }
        
        .option:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .option.selected {
            border-color: var(--primary);
            background-color: #e8f4fc;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .score-display {
            font-size: 2.5rem;
            text-align: center;
            margin: 30px 0;
            color: var(--secondary);
            font-weight: bold;
        }
        
        .answer-analysis {
            margin-top: 40px;
        }
        
        .correct {
            color: var(--success);
            font-weight: bold;
        }
        
        .incorrect {
            color: var(--accent);
            font-weight: bold;
        }
        
        .admin-section {
            margin-bottom: 40px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }
        
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
        }
        
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        
        tr:hover {
            background-color: #e8f4fc;
        }
        
        .tab-container {
            margin-top: 30px;
        }
        
        .tab-buttons {
            display: flex;
            margin-bottom: 20px;
            flex-wrap: wrap;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 5px;
        }
        
        .tab-btn {
            padding: 15px 25px;
            background: none;
            border: none;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s;
            flex: 1;
            min-width: 200px;
            text-align: center;
        }
        
        .tab-btn.active {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .tab-content {
            display: none;
            padding: 25px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .tab-content.active {
            display: block;
        }
        
        .logout-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            background: linear-gradient(to right, var(--accent), #c0392b);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .logout-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: var(--success);
            color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            display: none;
            z-index: 1000;
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .progress-bar {
            height: 10px;
            background: #eee;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            border-radius: 5px;
            transition: width 0.3s ease;
        }
        
        .question-number {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .q-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #eee;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .q-circle.current {
            background: var(--primary);
            color: white;
            transform: scale(1.1);
        }
        
        .q-circle.answered {
            background: var(--success);
            color: white;
        }
        
        .cloud-sync {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            z-index: 100;
            transition: all 0.3s;
        }
        
        .cloud-sync:hover {
            transform: translateY(-5px);
        }
        
        .cloud-sync i {
            font-size: 24px;
            color: var(--primary);
        }
        
        @media (max-width: 768px) {
            .btn-container {
                flex-direction: column;
            }
            
            .navigation {
                flex-direction: column;
            }
            
            .tab-buttons {
                flex-direction: column;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .description {
                font-size: 1.1rem;
            }
            
            .login-form, .dashboard, .test-container, .result-container, .admin-panel {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Halaman Utama -->
        <header id="home-page">
            <h1><i class="fas fa-brain"></i> CBT Pengetahuan Umum SMP</h1>
            <p class="description">Selamat datang di platform CBT matematika SMP Negeri 6 Amlapura. Selamat Mengerjakan!</p>
            <div class="btn-container">
                <button class="btn btn-primary" id="participant-login-btn">
                    <i class="fas fa-user-graduate"></i> Login Sebagai Peserta
                </button>
                <button class="btn btn-success" id="admin-login-btn">
                    <i class="fas fa-user-cog"></i> Login Sebagai Admin
                </button>
            </div>
        </header>

        <!-- Form Login Peserta -->
        <div class="login-form" id="participant-login">
            <h2><i class="fas fa-sign-in-alt"></i> Login Peserta</h2>
            <div class="form-group">
                <label for="participant-name"><i class="fas fa-user"></i> Nama</label>
                <input type="text" id="participant-name" placeholder="Masukkan nama lengkap">
            </div>
            <div class="form-group">
                <label for="participant-email"><i class="fas fa-envelope"></i> Email</label>
                <input type="email" id="participant-email" placeholder="Masukkan email">
            </div>
            <div class="form-group">
                <label for="participant-password"><i class="fas fa-lock"></i> Password</label>
                <input type="password" id="participant-password" placeholder="Masukkan password">
            </div>
            <button class="btn btn-primary" id="participant-login-submit">
                <i class="fas fa-sign-in-alt"></i> Login
            </button>
            <button class="btn btn-secondary" id="back-to-home">
                <i class="fas fa-arrow-left"></i> Kembali
            </button>
        </div>

        <!-- Form Login Admin -->
        <div class="login-form" id="admin-login">
            <h2><i class="fas fa-sign-in-alt"></i> Login Admin</h2>
            <div class="form-group">
                <label for="admin-email"><i class="fas fa-envelope"></i> Email</label>
                <input type="email" id="admin-email" placeholder="Masukkan email admin">
            </div>
            <div class="form-group">
                <label for="admin-password"><i class="fas fa-lock"></i> Password</label>
                <input type="password" id="admin-password" placeholder="Masukkan password admin">
            </div>
            <button class="btn btn-primary" id="admin-login-submit">
                <i class="fas fa-sign-in-alt"></i> Login
            </button>
            <button class="btn btn-secondary" id="back-to-home-admin">
                <i class="fas fa-arrow-left"></i> Kembali
            </button>
        </div>

        <!-- Dashboard Peserta -->
        <div class="dashboard" id="dashboard">
            <button class="logout-btn" id="logout-participant">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
            <div class="user-profile">
                <h2><i class="fas fa-user-circle"></i> Profil Pengguna</h2>
                <p><strong>Nama:</strong> <span id="profile-name"></span></p>
                <p><strong>Email:</strong> <span id="profile-email"></span></p>
                <p><strong>Kelas:</strong> <span id="profile-class"></span></p>
                <p><strong>Asal Sekolah:</strong> <span id="profile-school"></span></p>
            </div>
            
            <div class="rules">
                <h2><i class="fas fa-info-circle"></i> Keterangan Lomba</h2>
                <ol class="rule-list">
                    <li>Waktu Pengerjaan: Pastikan Anda memahami waktu yang diberikan untuk mengerjakan soal. Waktu pengerjaan adalah 120 menit.</li>
                    <li>Jumlah Soal: Terdapat 40 soal yang harus dikerjakan dalam waktu yang ditentukan.</li>
                    <li>Pilih Jawaban: Pilih jawaban yang paling tepat untuk setiap soal.</li>
                    <li>Navigasi: Anda dapat berpindah antar soal menggunakan tombol navigasi yang disediakan.</li>
                    <li>Pengiriman Jawaban: Setelah selesai, klik tombol "Kirim" untuk mengirimkan jawaban Anda.</li>
                    <li>Koneksi Internet: Pastikan koneksi internet Anda stabil selama pengerjaan soal.</li>
                    <li>Tidak Ada Diskusi: Anda tidak diperbolehkan berdiskusi dengan peserta lain.</li>
                    <li>Tidak Ada Bantuan: Anda tidak diperbolehkan menggunakan bantuan lain seperti buku atau catatan.</li>
                    <li>Periksa Jawaban: Pastikan Anda telah memeriksa semua jawaban Anda sebelum mengirim.</li>
                    <li>Kepatuhan: Pastikan Anda mematuhi semua peraturan yang diberikan.</li>
                </ol>
                <p><strong>Format Jawaban:</strong> Pilihan ganda dengan 4 opsi (A, B, C, D)</p>
                <p><strong>Tingkat Kesulitan:</strong> Soal-soal level mudah, namun tetap fokus dan teliti.</p>
            </div>
            
            <button class="btn btn-success" id="start-test">
                <i class="fas fa-play"></i> Mulai Tes
            </button>
        </div>

        <!-- Halaman Tes -->
        <div class="test-container" id="test-container">
            <button class="logout-btn" id="logout-during-test">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
            <div class="timer" id="timer">
                <i class="fas fa-clock"></i> Waktu tersisa: 120:00
            </div>
            
            <div class="progress-bar">
                <div class="progress" id="progress-bar"></div>
            </div>
            
            <div class="question-number" id="question-numbers">
                <!-- Nomor soal akan diisi oleh JavaScript -->
            </div>
            
            <div id="questions-container">
                <!-- Soal akan dimuat di sini melalui JavaScript -->
            </div>
            
            <div class="navigation">
                <button class="btn btn-primary" id="prev-question">
                    <i class="fas fa-arrow-left"></i> Soal Sebelumnya
                </button>
                <button class="btn btn-primary" id="next-question">
                    Soal Berikutnya <i class="fas fa-arrow-right"></i>
                </button>
            </div>
            
            <button class="btn btn-success" id="submit-test">
                <i class="fas fa-paper-plane"></i> Kirim Jawaban
            </button>
        </div>

        <!-- Halaman Hasil -->
        <div class="result-container" id="result-container">
            <h2><i class="fas fa-chart-line"></i> Hasil Tes</h2>
            <div class="score-display">
                Skor Anda: <span id="final-score">0</span>
            </div>
            
            <div class="answer-analysis" id="answer-analysis">
                <!-- Analisis jawaban akan dimuat di sini -->
            </div>
            
            <button class="btn btn-primary" id="back-to-home-from-result">
                <i class="fas fa-home"></i> Kembali ke Beranda
            </button>
        </div>

        <!-- Panel Admin -->
        <div class="admin-panel" id="admin-panel">
            <button class="logout-btn" id="logout-admin">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
            <h2><i class="fas fa-cog"></i> Panel Admin</h2>
            
            <div class="tab-container">
                <div class="tab-buttons">
                    <button class="tab-btn active" data-tab="participant-management">
                        <i class="fas fa-users"></i> Manajemen Peserta
                    </button>
                    <button class="tab-btn" data-tab="question-management">
                        <i class="fas fa-question-circle"></i> Manajemen Soal
                    </button>
                    <button class="tab-btn" data-tab="results-management">
                        <i class="fas fa-chart-bar"></i> Hasil & Laporan
                    </button>
                </div>
                
                <div class="tab-content active" id="participant-management">
                    <div class="admin-section">
                        <h3><i class="fas fa-user-plus"></i> Pendaftaran Peserta</h3>
                        <div class="form-group">
                            <label for="new-participant-name">Nama</label>
                            <input type="text" id="new-participant-name">
                        </div>
                        <div class="form-group">
                            <label for="new-participant-email">Email</label>
                            <input type="email" id="new-participant-email">
                        </div>
                        <div class="form-group">
                            <label for="new-participant-password">Password</label>
                            <input type="password" id="new-participant-password">
                        </div>
                        <div class="form-group">
                            <label for="new-participant-class">Kelas</label>
                            <input type="text" id="new-participant-class">
                        </div>
                        <div class="form-group">
                            <label for="new-participant-school">Asal Sekolah</label>
                            <input type="text" id="new-participant-school">
                        </div>
                        <button class="btn btn-primary" id="add-participant">
                            <i class="fas fa-plus"></i> Tambah Peserta
                        </button>
                    </div>
                    
                    <div class="admin-section">
                        <h3><i class="fas fa-list"></i> Daftar Peserta Terdaftar</h3>
                        <table id="participants-table">
                            <thead>
                                <tr>
                                    <th>Nama</th>
                                    <th>Email</th>
                                    <th>Kelas</th>
                                    <th>Sekolah</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data peserta akan dimuat di sini -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="tab-content" id="question-management">
                    <div class="admin-section">
                        <h3><i class="fas fa-plus-circle"></i> Tambah Soal Baru</h3>
                        <div class="form-group">
                            <label for="question-text">Pertanyaan</label>
                            <textarea id="question-text" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Opsi Jawaban</label>
                            <input type="text" id="option-a" placeholder="Opsi A">
                            <input type="text" id="option-b" placeholder="Opsi B">
                            <input type="text" id="option-c" placeholder="Opsi C">
                            <input type="text" id="option-d" placeholder="Opsi D">
                        </div>
                        <div class="form-group">
                            <label for="correct-answer">Jawaban Benar</label>
                            <select id="correct-answer">
                                <option value="a">A</option>
                                <option value="b">B</option>
                                <option value="c">C</option>
                                <option value="d">D</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" id="add-question">
                            <i class="fas fa-plus"></i> Tambah Soal
                        </button>
                    </div>
                    
                    <div class="admin-section">
                        <h3><i class="fas fa-list"></i> Daftar Soal</h3>
                        <table id="questions-table">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Pertanyaan</th>
                                    <th>Jawaban Benar</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data soal akan dimuat di sini -->
                            </tbody>
                        </table>
                        
                        <button class="btn btn-success" id="publish-questions">
                            <i class="fas fa-cloud-upload-alt"></i> Publikasikan Soal
                        </button>
                    </div>
                </div>
                
                <div class="tab-content" id="results-management">
                    <div class="admin-section">
                        <h3><i class="fas fa-trophy"></i> Hasil Peserta</h3>
                        <table id="results-table">
                            <thead>
                                <tr>
                                    <th>Peringkat</th>
                                    <th>Nama</th>
                                    <th>Email</th>
                                    <th>Sekolah</th>
                                    <th>Skor</th>
                                    <th>Detail</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data hasil akan dimuat di sini -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <div class="cloud-sync" id="cloud-sync" title="Sinkronisasi dengan Cloud">
        <i class="fas fa-cloud-upload-alt"></i>
    </div>

    <script>
        // Data akan disimpan di localStorage browser dengan backup ke Google Sheets
        const scriptURL = 'https://script.google.com/macros/s/AKfycbzEXAMPLE/exec'; // Ganti dengan URL Apps Script Anda
        
        function initializeData() {
            if (!localStorage.getItem('participants')) {
                localStorage.setItem('participants', JSON.stringify([]));
            }
            
            if (!localStorage.getItem('questions')) {
                // Soal contoh
                const sampleQuestions = [
                    {
                        id: 1,
                        text: "Berapakah hasil dari 8 × 7?",
                        options: {
                            a: "54",
                            b: "56",
                            c: "58",
                            d: "60"
                        },
                        correctAnswer: "b"
                    },
                    {
                        id: 2,
                        text: "Apa ibukota Indonesia?",
                        options: {
                            a: "Jakarta",
                            b: "Bandung",
                            c: "Surabaya",
                            d: "Medan"
                        },
                        correctAnswer: "a"
                    },
                    {
                        id: 3,
                        text: "Planet terdekat dari matahari adalah?",
                        options: {
                            a: "Venus",
                            b: "Bumi",
                            c: "Mars",
                            d: "Merkurius"
                        },
                        correctAnswer: "d"
                    }
                ];
                localStorage.setItem('questions', JSON.stringify(sampleQuestions));
            }
            
            if (!localStorage.getItem('results')) {
                localStorage.setItem('results', JSON.stringify([]));
            }
            
            if (!localStorage.getItem('adminAccounts')) {
                const adminAccounts = [
                    { email: "admin@smplomba.id", password: "admin123" }
                ];
                localStorage.setItem('adminAccounts', JSON.stringify(adminAccounts));
            }
        }
        
        // Fungsi untuk mendapatkan data dari localStorage
        function getParticipants() {
            return JSON.parse(localStorage.getItem('participants'));
        }
        
        function getQuestions() {
            return JSON.parse(localStorage.getItem('questions'));
        }
        
        function getResults() {
            return JSON.parse(localStorage.getItem('results'));
        }
        
        function getAdminAccounts() {
            return JSON.parse(localStorage.getItem('adminAccounts'));
        }
        
        // Fungsi untuk menyimpan data ke localStorage
        function saveParticipants(participants) {
            localStorage.setItem('participants', JSON.stringify(participants));
        }
        
        function saveQuestions(questions) {
            localStorage.setItem('questions', JSON.stringify(questions));
        }
        
        function saveResults(results) {
            localStorage.setItem('results', JSON.stringify(results));
        }
        
        // Fungsi untuk menyinkronkan data dengan Google Sheets
        async function syncWithCloud() {
            showNotification('Menyinkronkan data dengan cloud...');
            
            try {
                // Kirim data peserta
                const participants = getParticipants();
                const questions = getQuestions();
                const results = getResults();
                
                // Simulasi pengiriman data (dalam implementasi nyata, gunakan fetch ke Apps Script)
                console.log('Mengirim data ke cloud:', { participants, questions, results });
                
                // Simulasi delay jaringan
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                showNotification('Data berhasil disinkronkan dengan cloud!');
            } catch (error) {
                console.error('Error syncing with cloud:', error);
                showNotification('Gagal menyinkronkan dengan cloud', 'error');
            }
        }
        
        // Inisialisasi data
        initializeData();
        
        // Elemen DOM
        const homePage = document.getElementById('home-page');
        const participantLogin = document.getElementById('participant-login');
        const adminLogin = document.getElementById('admin-login');
        const dashboard = document.getElementById('dashboard');
        const testContainer = document.getElementById('test-container');
        const resultContainer = document.getElementById('result-container');
        const adminPanel = document.getElementById('admin-panel');
        const notification = document.getElementById('notification');
        const cloudSync = document.getElementById('cloud-sync');
        
        // Variabel state
        let currentUser = null;
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let timerInterval = null;
        let timeLeft = 120 * 60; // 120 menit dalam detik
        
        // Event Listeners
        document.getElementById('participant-login-btn').addEventListener('click', () => {
            homePage.style.display = 'none';
            participantLogin.style.display = 'block';
        });
        
        document.getElementById('admin-login-btn').addEventListener('click', () => {
            homePage.style.display = 'none';
            adminLogin.style.display = 'block';
        });
        
        document.getElementById('back-to-home').addEventListener('click', () => {
            participantLogin.style.display = 'none';
            homePage.style.display = 'block';
        });
        
        document.getElementById('back-to-home-admin').addEventListener('click', () => {
            adminLogin.style.display = 'none';
            homePage.style.display = 'block';
        });
        
        document.getElementById('participant-login-submit').addEventListener('click', () => {
            const email = document.getElementById('participant-email').value;
            const password = document.getElementById('participant-password').value;
            const name = document.getElementById('participant-name').value;
            
            const participants = getParticipants();
            const participant = participants.find(p => p.email === email && p.password === password && p.name === name);
            
            if (participant) {
                currentUser = participant;
                participantLogin.style.display = 'none';
                dashboard.style.display = 'block';
                
                // Isi profil pengguna
                document.getElementById('profile-name').textContent = participant.name;
                document.getElementById('profile-email').textContent = participant.email;
                document.getElementById('profile-class').textContent = participant.class;
                document.getElementById('profile-school').textContent = participant.school;
                
                showNotification('Login berhasil! Selamat datang ' + participant.name);
            } else {
                showNotification('Email, nama, atau password salah. Silakan coba lagi.', 'error');
            }
        });
        
        document.getElementById('admin-login-submit').addEventListener('click', () => {
            const email = document.getElementById('admin-email').value;
            const password = document.getElementById('admin-password').value;
            
            const adminAccounts = getAdminAccounts();
            const admin = adminAccounts.find(a => a.email === email && a.password === password);
            
            if (admin) {
                adminLogin.style.display = 'none';
                adminPanel.style.display = 'block';
                loadParticipantsTable();
                loadQuestionsTable();
                loadResultsTable();
                showNotification('Login admin berhasil!');
            } else {
                showNotification('Email atau password admin salah.', 'error');
            }
        });
        
        document.getElementById('start-test').addEventListener('click', () => {
            dashboard.style.display = 'none';
            testContainer.style.display = 'block';
            
            // Inisialisasi jawaban user
            const questions = getQuestions();
            userAnswers = new Array(questions.length).fill(null);
            
            // Load soal pertama
            loadQuestion(0);
            
            // Buat nomor soal
            createQuestionNumbers();
            
            // Mulai timer
            startTimer();
        });
        
        document.getElementById('submit-test').addEventListener('click', () => {
            if (confirm('Apakah Anda yakin ingin mengirim jawaban? Setelah dikirim, Anda tidak dapat mengubahnya.')) {
                clearInterval(timerInterval);
                calculateScore();
                testContainer.style.display = 'none';
                resultContainer.style.display = 'block';
            }
        });
        
        document.getElementById('back-to-home-from-result').addEventListener('click', () => {
            resultContainer.style.display = 'none';
            homePage.style.display = 'block';
            currentUser = null;
        });
        
        document.getElementById('logout-participant').addEventListener('click', () => {
            if (confirm('Apakah Anda yakin ingin logout?')) {
                if (timerInterval) clearInterval(timerInterval);
                dashboard.style.display = 'none';
                homePage.style.display = 'block';
                currentUser = null;
                showNotification('Anda telah logout');
            }
        });
        
        document.getElementById('logout-during-test').addEventListener('click', () => {
            if (confirm('Apakah Anda yakin ingin logout? Semua jawaban yang telah diisi akan hilang.')) {
                clearInterval(timerInterval);
                testContainer.style.display = 'none';
                homePage.style.display = 'block';
                currentUser = null;
                showNotification('Anda telah logout');
            }
        });
        
        document.getElementById('logout-admin').addEventListener('click', () => {
            adminPanel.style.display = 'none';
            homePage.style.display = 'block';
            showNotification('Anda telah logout dari panel admin');
        });
        
        document.getElementById('prev-question').addEventListener('click', () => {
            if (currentQuestionIndex > 0) {
                saveAnswer();
                loadQuestion(currentQuestionIndex - 1);
            }
        });
        
        document.getElementById('next-question').addEventListener('click', () => {
            const questions = getQuestions();
            if (currentQuestionIndex < questions.length - 1) {
                saveAnswer();
                loadQuestion(currentQuestionIndex + 1);
            }
        });
        
        document.getElementById('add-participant').addEventListener('click', () => {
            const name = document.getElementById('new-participant-name').value;
            const email = document.getElementById('new-participant-email').value;
            const password = document.getElementById('new-participant-password').value;
            const classVal = document.getElementById('new-participant-class').value;
            const school = document.getElementById('new-participant-school').value;
            
            if (name && email && password && classVal && school) {
                const participants = getParticipants();
                
                // Cek apakah email sudah terdaftar
                if (participants.some(p => p.email === email)) {
                    showNotification('Email sudah terdaftar. Gunakan email lain.', 'error');
                    return;
                }
                
                participants.push({
                    name,
                    email,
                    password,
                    class: classVal,
                    school
                });
                
                saveParticipants(participants);
                loadParticipantsTable();
                
                // Reset form
                document.getElementById('new-participant-name').value = '';
                document.getElementById('new-participant-email').value = '';
                document.getElementById('new-participant-password').value = '';
                document.getElementById('new-participant-class').value = '';
                document.getElementById('new-participant-school').value = '';
                
                showNotification('Peserta berhasil ditambahkan.');
            } else {
                showNotification('Harap isi semua field.', 'error');
            }
        });
        
        document.getElementById('add-question').addEventListener('click', () => {
            const text = document.getElementById('question-text').value;
            const optionA = document.getElementById('option-a').value;
            const optionB = document.getElementById('option-b').value;
            const optionC = document.getElementById('option-c').value;
            const optionD = document.getElementById('option-d').value;
            const correctAnswer = document.getElementById('correct-answer').value;
            
            if (text && optionA && optionB && optionC && optionD) {
                const questions = getQuestions();
                
                questions.push({
                    id: questions.length + 1,
                    text,
                    options: {
                        a: optionA,
                        b: optionB,
                        c: optionC,
                        d: optionD
                    },
                    correctAnswer
                });
                
                saveQuestions(questions);
                loadQuestionsTable();
                
                // Reset form
                document.getElementById('question-text').value = '';
                document.getElementById('option-a').value = '';
                document.getElementById('option-b').value = '';
                document.getElementById('option-c').value = '';
                document.getElementById('option-d').value = '';
                
                showNotification('Soal berhasil ditambahkan.');
            } else {
                showNotification('Harap isi semua field.', 'error');
            }
        });
        
        document.getElementById('publish-questions').addEventListener('click', () => {
            const questions = getQuestions();
            if (questions.length > 0) {
                showNotification('Soal telah dipublikasikan dan siap untuk digunakan peserta.');
            } else {
                showNotification('Tidak ada soal untuk dipublikasikan. Silakan tambahkan soal terlebih dahulu.', 'error');
            }
        });
        
        // Tab functionality untuk admin panel
        document.querySelectorAll('.tab-btn').forEach(button => {
            button.addEventListener('click', () => {
                // Remove active class from all buttons and content
                document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                // Add active class to clicked button and corresponding content
                button.classList.add('active');
                document.getElementById(button.dataset.tab).classList.add('active');
            });
        });
        
        // Cloud sync functionality
        cloudSync.addEventListener('click', syncWithCloud);
        
        // Fungsi bantuan
        function loadQuestion(index) {
            const questions = getQuestions();
            currentQuestionIndex = index;
            const question = questions[index];
            
            const questionsContainer = document.getElementById('questions-container');
            questionsContainer.innerHTML = `
                <div class="question">
                    <h3>Soal ${index + 1} dari ${questions.length}</h3>
                    <p>${question.text}</p>
                    <div class="options">
                        <div class="option ${userAnswers[index] === 'a' ? 'selected' : ''}" data-value="a">
                            <input type="radio" id="option-a" name="answer" value="a" ${userAnswers[index] === 'a' ? 'checked' : ''}>
                            <label for="option-a">A. ${question.options.a}</label>
                        </div>
                        <div class="option ${userAnswers[index] === 'b' ? 'selected' : ''}" data-value="b">
                            <input type="radio" id="option-b" name="answer" value="b" ${userAnswers[index] === 'b' ? 'checked' : ''}>
                            <label for="option-b">B. ${question.options.b}</label>
                        </div>
                        <div class="option ${userAnswers[index] === 'c' ? 'selected' : ''}" data-value="c">
                            <input type="radio" id="option-c" name="answer" value="c" ${userAnswers[index] === 'c' ? 'checked' : ''}>
                            <label for="option-c">C. ${question.options.c}</label>
                        </div>
                        <div class="option ${userAnswers[index] === 'd' ? 'selected' : ''}" data-value="d">
                            <input type="radio" id="option-d" name="answer" value="d" ${userAnswers[index] === 'd' ? 'checked' : ''}>
                            <label for="option-d">D. ${question.options.d}</label>
                        </div>
                    </div>
                </div>
            `;
            
            // Tambahkan event listener untuk opsi
            document.querySelectorAll('.option').forEach(option => {
                option.addEventListener('click', (e) => {
                    const value = option.getAttribute('data-value');
                    document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                    
                    const radio = option.querySelector('input[type="radio"]');
                    radio.checked = true;
                    
                    userAnswers[index] = value;
                    updateQuestionNumbers();
                });
            });
            
            // Tambahkan event listener untuk radio buttons
            document.querySelectorAll('input[name="answer"]').forEach(radio => {
                radio.addEventListener('change', (e) => {
                    userAnswers[index] = e.target.value;
                    document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
                    e.target.closest('.option').classList.add('selected');
                    updateQuestionNumbers();
                });
            });
            
            // Update status navigasi tombol
            document.getElementById('prev-question').disabled = index === 0;
            document.getElementById('next-question').disabled = index === questions.length - 1;
            
            // Update progress bar
            const progress = ((index + 1) / questions.length) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;
            
            // Update question numbers
            updateQuestionNumbers();
        }
        
        function createQuestionNumbers() {
            const questions = getQuestions();
            const container = document.getElementById('question-numbers');
            container.innerHTML = '';
            
            questions.forEach((_, index) => {
                const circle = document.createElement('div');
                circle.className = 'q-circle';
                circle.textContent = index + 1;
                circle.addEventListener('click', () => {
                    saveAnswer();
                    loadQuestion(index);
                });
                container.appendChild(circle);
            });
            
            updateQuestionNumbers();
        }
        
        function updateQuestionNumbers() {
            const circles = document.querySelectorAll('.q-circle');
            circles.forEach((circle, index) => {
                circle.classList.remove('current', 'answered');
                
                if (index === currentQuestionIndex) {
                    circle.classList.add('current');
                }
                
                if (userAnswers[index] !== null) {
                    circle.classList.add('answered');
                }
            });
        }
        
        function saveAnswer() {
            const selectedOption = document.querySelector('input[name="answer"]:checked');
            if (selectedOption) {
                userAnswers[currentQuestionIndex] = selectedOption.value;
            }
        }
        
        function startTimer() {
            timeLeft = 120 * 60; // 120 menit
            updateTimerDisplay();
            
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    alert('Waktu telah habis! Jawaban akan dikirim otomatis.');
                    calculateScore();
                    testContainer.style.display = 'none';
                    resultContainer.style.display = 'block';
                }
            }, 1000);
        }
        
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            document.getElementById('timer').textContent = `Waktu tersisa: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Ubah warna menjadi merah ketika waktu hampir habis
            if (timeLeft < 300) { // 5 menit
                document.getElementById('timer').style.background = 'linear-gradient(to right, #e74c3c, #c0392b)';
            }
        }
        
        function calculateScore() {
            const questions = getQuestions();
            let score = 0;
            let correctAnswers = 0;
            let wrongAnswers = 0;
            let unanswered = 0;
            
            const answerAnalysis = document.getElementById('answer-analysis');
            answerAnalysis.innerHTML = '<h3>Analisis Jawaban</h3>';
            
            questions.forEach((question, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === question.correctAnswer;
                
                if (userAnswer === null) {
                    unanswered++;
                } else if (isCorrect) {
                    score += 2;
                    correctAnswers++;
                } else {
                    score -= 1;
                    wrongAnswers++;
                }
                
                // Tambahkan analisis per soal
                const answerDiv = document.createElement('div');
                answerDiv.classList.add('question-analysis');
                answerDiv.innerHTML = `
                    <p><strong>Soal ${index + 1}:</strong> ${question.text}</p>
                    <p class="${isCorrect ? 'correct' : 'incorrect'}">Jawaban Anda: ${userAnswer ? userAnswer.toUpperCase() : 'Tidak dijawab'} ${userAnswer ? `(${question.options[userAnswer]})` : ''}</p>
                    <p class="correct">Jawaban Benar: ${question.correctAnswer.toUpperCase()} (${question.options[question.correctAnswer]})</p>
                    <hr>
                `;
                answerAnalysis.appendChild(answerDiv);
            });
            
            // Simpan hasil
            if (currentUser) {
                const results = getResults();
                results.push({
                    participant: currentUser.email,
                    name: currentUser.name,
                    school: currentUser.school,
                    score,
                    correctAnswers,
                    wrongAnswers,
                    unanswered,
                    answers: userAnswers
                });
                
                saveResults(results);
            }
            
            // Tampilkan skor
            document.getElementById('final-score').textContent = score;
        }
        
        function loadParticipantsTable() {
            const participants = getParticipants();
            const tableBody = document.querySelector('#participants-table tbody');
            tableBody.innerHTML = '';
            
            participants.forEach(participant => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${participant.name}</td>
                    <td>${participant.email}</td>
                    <td>${participant.class}</td>
                    <td>${participant.school}</td>
                    <td>
                        <button class="btn btn-danger" style="padding: 8px;" onclick="deleteParticipant('${participant.email}')">
                            <i class="fas fa-trash"></i> Hapus
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        function loadQuestionsTable() {
            const questions = getQuestions();
            const tableBody = document.querySelector('#questions-table tbody');
            tableBody.innerHTML = '';
            
            questions.forEach((question, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${question.text}</td>
                    <td>${question.correctAnswer.toUpperCase()}</td>
                    <td>
                        <button class="btn btn-danger" style="padding: 8px;" onclick="deleteQuestion(${index})">
                            <i class="fas fa-trash"></i> Hapus
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        function loadResultsTable() {
            const results = getResults();
            const tableBody = document.querySelector('#results-table tbody');
            tableBody.innerHTML = '';
            
            // Urutkan hasil berdasarkan skor (tertinggi ke terendah)
            const sortedResults = [...results].sort((a, b) => b.score - a.score);
            
            sortedResults.forEach((result, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${result.name}</td>
                    <td>${result.participant}</td>
                    <td>${result.school}</td>
                    <td>${result.score}</td>
                    <td>
                        <button class="btn btn-primary" style="padding: 8px;" onclick="viewResultDetails('${result.participant}')">
                            <i class="fas fa-eye"></i> Lihat Detail
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        function showNotification(message, type = 'success') {
            notification.textContent = message;
            notification.style.display = 'block';
            notification.style.background = type === 'success' ? 'linear-gradient(to right, var(--success), #219652)' : 'linear-gradient(to right, var(--accent), #c0392b)';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }
        
        // Fungsi global untuk diakses dari onclick
        window.deleteParticipant = function(email) {
            if (confirm('Apakah Anda yakin ingin menghapus peserta ini?')) {
                const participants = getParticipants();
                const updatedParticipants = participants.filter(p => p.email !== email);
                saveParticipants(updatedParticipants);
                loadParticipantsTable();
                showNotification('Peserta berhasil dihapus.');
            }
        };
        
        window.deleteQuestion = function(index) {
            if (confirm('Apakah Anda yakin ingin menghapus soal ini?')) {
                const questions = getQuestions();
                questions.splice(index, 1);
                saveQuestions(questions);
                loadQuestionsTable();
                showNotification('Soal berhasil dihapus.');
            }
        };
        
        window.viewResultDetails = function(email) {
            const results = getResults();
            const result = results.find(r => r.participant === email);
            if (result) {
                let details = `Detail Hasil untuk ${result.name}:\n`;
                details += `Skor: ${result.score}\n`;
                details += `Jawaban Benar: ${result.correctAnswers}\n`;
                details += `Jawaban Salah: ${result.wrongAnswers}\n`;
                details += `Tidak Dijawab: ${result.unanswered}\n\n`;
                
                const questions = getQuestions();
                questions.forEach((question, index) => {
                    const userAnswer = result.answers[index];
                    details += `Soal ${index + 1}: ${userAnswer ? userAnswer.toUpperCase() : 'Tidak dijawab'}\n`;
                });
                
                alert(details);
            }
        };
    </script>
</body>
</html>
